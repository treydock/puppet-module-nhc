# File managed by Puppet, do not edit!
#
# NHC Configuration File
#
# Lines are in the form "<hostmask>||<check>"
# Hostmask is a glob or /regexp/
# Comments begin with '#'
#
# $Id$
#

#######################################################################
###
### NHC Configuration Variables
###
<%-
host_settings = {}
@settings.keys.sort.each do |setting|
  if @settings[setting].is_a?(Hash)
    if ! host_settings.has_key?(setting)
      host_settings[setting] = {}
    end
    @settings[setting].keys.sort.each do |s|
      host_settings[setting][s] = @settings[setting][s]
    end
  else
    if ! host_settings.has_key?('*')
      host_settings['*'] = {}
    end
    host_settings['*'][setting] = @settings[setting]
  end
end
-%>

<%- host_settings.keys.sort.each do |host| -%>
  <%- host_settings[host].keys.sort.each do |setting| -%>
    <%- value = host_settings[host][setting] -%>
    <%- if scope.function_is_bool([value]) -%>
<%= host %> || export <%= setting %>=<%= value ? "1" : "0" %>
    <%- else -%>
<%= host %> || export <%= setting %>=<%= value %>
    <%- end -%>
  <%- end -%>
<%- end -%>

#######################################################################
###
### Checks
###

<% if @checks.is_a?(Array) -%>
  <%- @checks.each do |check| -%>
* || <%= check %>
  <%- end -%>
<%- else -%>
  <%- if all_hosts = @checks.delete('*') -%>
    <%- all_hosts.each do |check| -%>
* || <%= check %>
    <%- end -%>
  <%- end -%>
  <%- @checks.keys.sort.each do |host| %>
    <%- if @checks[host].is_a?(Array) -%>
      <%- @checks[host].each do |check| -%>
<%= host %> || <%= check %>
      <%- end -%>
    <%- else -%>
<%= host %> || <%= @checks[host] %>
    <%- end -%>
  <%- end -%>
<%- end -%>
